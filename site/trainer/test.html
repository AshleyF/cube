<!DOCTYPE html>
<html lang=en>
    <head>
        <title>Test</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <link rel="stylesheet" type="text/css" href="styles.css">
        <script src="jquery.min.js"></script>
        <script src="roofpig_and_three.min.js"></script>
        <script src="cube.js"></script>
        <script src="display.js"></script>
        <script src="giiker.js"></script>
        <script>
            function tests() {
                var results = "";
                function test(name, fn) {
                    results += "<li style='color:" + (fn() ? "green" : "red") + "'>" + name + "</li>";
                }
                function testAlg(alg, expected) {
                    test("Alg: " + alg, function() { return Cube.toString(Cube.alg(alg, Cube.solved)) == expected; })
                }
                test("Solved", function() { return Cube.toString(Cube.solved) == "UUUUUUUUULLLLLLLLLFFFFFFFFFRRRRRRRRRDDDDDDDDDBBBBBBBBB"; });
                testAlg("U", "UUUUUUUUUFFFLLLLLLRRRFFFFFFBBBRRRRRRDDDDDDDDDBBBBBBLLL");
                testAlg("u", "UUUUUUUUUFFFFFFLLLRRRRRRFFFBBBBBBRRRDDDDDDDDDBBBLLLLLL");
                testAlg("u'", "UUUUUUUUUBBBBBBLLLLLLLLLFFFFFFFFFRRRDDDDDDDDDBBBRRRRRR");
                testAlg("u2", "UUUUUUUUURRRRRRLLLBBBBBBFFFLLLLLLRRRDDDDDDDDDBBBFFFFFF");
                testAlg("d", "UUUUUUUUULLLBBBBBBFFFLLLLLLRRRFFFFFFDDDDDDDDDRRRRRRBBB");
                testAlg("d'", "UUUUUUUUUBBBFFFFFFLLLRRRRRRFFFBBBBBBDDDDDDDDDLLLLLLRRR");
                testAlg("d2", "UUUUUUUUULLLRRRRRRFFFBBBBBBRRRLLLLLLDDDDDDDDDFFFFFFBBB");
                // testAlg("l", "");
                // testAlg("l'", "");
                // testAlg("l2", "");
                // testAlg("r", "");
                // testAlg("r'", "");
                // testAlg("r2", "");
                // testAlg("f", "");
                // testAlg("f'", "");
                // testAlg("f2", "");
                // testAlg("b", "");
                // testAlg("b'", "");
                // testAlg("b2", "");
                test("Comparison", function() { return Cube.same(Cube.alg("U L", Cube.solved), Cube.alg("U L", Cube.solved)); });
                test("Equivalent", function() { return Cube.same(Cube.alg("U R", Cube.solved), Cube.alg("x2 D R", Cube.solved)); });
                document.getElementById("results").innerHTML = results;
            }

            function displayAlg(alg) {
                var cube = Cube.alg(alg, Cube.solved);
                document.getElementById("debug").innerText = Cube.toString(cube);
                function delay() {
                    Display.display3DCube(Cube.faces(cube), "cube");
                    Display.displayLL(Cube.faces(cube), "ll");
                    Display.displayUF(Cube.faces(cube), "uf");
                }
                window.setTimeout(delay, 1);
            }

            function load() {
                tests();
                displayAlg("d2");
                /*
                var x = Cube.solved;
                // prompt("Cube", Cube.toString(Cube.alg("U", Cube.solved)));
                x = Cube.random(["x", "x'", "x2", "y", "y'", "y2", "z", "z'", "z2"], 100, x);
                x = Cube.random(["U", "U'", "U2", "M", "M'", "M2"], 100, x);
                x = Cube.random(["", "U", "U'", "U2"], 1, x);
                function delay() {
                    Display.display3DCube(Cube.faces(x), "cube");
                    Display.displayLL(Cube.faces(x), "ll");
                    Display.displayUF(Cube.faces(x), "uf");
                }
                window.setTimeout(delay, 1);
                */
            }

            function twist(t) {
                alert(JSON.stringify(t));
            }

            function connected(success, exception) {
                if (success) {
                    document.getElementById("connect").style = "display:none";
                } else {
                    alert("Error: " + exception.message);
                }
            }

            function connect() {
                Giiker.connect(connected, twist);
                document.getElementById("connect").Enabled = false;
            }

            function disconnect() {
                Giiker.disconnect();
                // TODO: toggle button
            }
        </script>
    </head>
    <body onload="load()" style="background: black">
        <h1>Tests v0.6</h1>
        <ol id="results">
        </ol>
        <div id="cube" style="width: 700px"></div>
        <div id="ll" style="width: 300px"></div>
        <div id="uf" style="width: 300px"></div>
        <button id="connect" onclick="connect()">Connect</button>
        <button id="disconnect" enabled="false" onclick="disconnect()">Disconnect</button>
        <p id="debug"></p>
    </body>
</html>
